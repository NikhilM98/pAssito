<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Demo App</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDj6mdf1-Un64guiGoDmy7EcbgwTxq5dMI&libraries=places"></script>
    </head>
    <body>
        <div class="container" style="background-color:grey;height:100%;">
            <div class="row">
                <div id="nextclass" class="col-md-6" style="background-color:grey;height:50vh;"></div>
                <div id="nextmess" class="col-md-6" style="background-color:grey;height:50vh"></div>
                <div onclick="getTimeTable()" class="col-sm-6" style="background-color:grey;height:50vh">
                    <a href="timetable.json"> getTimeTable</a>
                </div>
                <div onclick="getMessMenu()" class="col-sm-6" style="background-color:grey;height:50vh;">
                    <a href="messmenu.json"> getMessMenu</a>
                </div>
            </div>
            <div id="imagebox" style="height:50vh; width:50vw;"></div>
        </div>
        <script>
            var secondvariable = {
                "messmenu" : [
                    {//Sunday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Monday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Tuesday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Wednesday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Thursday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Friday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    },
                    {//Saturday
                        "breakfast" : "Milk",
                        "lunch": "Rice",
                        "dinner": "Omlette" 
                    }
                ],
                "status" : "OK"
            };
            var variable = {
                "timetable" : [
                    [//Sunday
                            {//0: 8 - 9
                                "event_name" : "8 - 9",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //1: 9 - 10
                            {
                                "event_name" : "9 - 10",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //2: 10 - 11
                            {
                                "event_name" : "10 - 11",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //3: 11 - 12
                            {
                                "event_name" : "11 - 12",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //4: 12 - 13
                            {
                                "event_name" : "12 - 13",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //5: 13 - 14
                            {
                                "event_name" : "13 - 14",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //6: 14 - 15
                            {
                                "event_name" : "14 - 15",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //7: 15 - 16
                            {
                                "event_name" : "15 - 16",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //8: 16 - 17
                            {
                                "event_name" : "16 - 17",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //9: 17 - 18
                            {
                                "event_name" : "17 - 18",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //10: 18 - 19
                            {
                                "event_name" : "18 - 19",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //11: 19 - 20
                            {
                                "event_name" : "19 - 20",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        ,
                        //12: 20 - 21
                            {
                                "event_name" : "20 - 21",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                        
                    ],[//Sunday
                        //0: 8 - 9
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //1: 9 - 10
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //2: 10 - 11
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //3: 11 - 12
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //4: 12 - 13
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //5: 13 - 14
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //6: 14 - 15
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //7: 15 - 16
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //8: 16 - 17
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //9: 17 - 18
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //10: 18 - 19
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //11: 19 - 20
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            },
                        //12: 20 - 21
                        {
                                "event_name" : "Lunch",
                                "place_location" : "RKB Mess",
                                "greeting": "",
                                "earlyadd": "",
                                "slot": ""
                            }
                    ]
                ],
                "status" : "OK"
            };
            var prevlogged = 100;
            setInterval(function() {
                var now = new Date();
                var hours = now.getHours();
                var minutes = now.getMinutes();
                var day = now.getDay();
                var clock = hours + minutes/60.0;
                var index = 0;
                    if ((clock > 8 && clock < 9) && (prevlogged !== 0)) {
                        prevlogged = 0;
                        console.log(variable.timetable[day][0].event_name + ' ' + variable.timetable[day][0].place_location + ' ' + variable.timetable[day][0].greeting);
                        console.log(secondvariable.messmenu[day].breakfast);
                        // Push Message
                        // document.getElementById >> Inner html >> secondvariable.messmenu[day].breakfast
                    } else if ((clock > 12 && clock < 13) && (prevlogged !== 4)) {
                        prevlogged = 4;
                        console.log(variable.timetable[day][4].event_name + ' ' + variable.timetable[day][4].place_location + ' ' + variable.timetable[day][4].greeting);
                        console.log(secondvariable.messmenu[day].lunch);
                        // Push Message
                        // document.getElementById >> Inner html >> secondvariable.messmenu[day].lunch
                    } else if ((clock > 20 && clock < 21) && (prevlogged !== 12)) {
                        prevlogged = 12;
                        console.log(variable.timetable[day][12].event_name + ' ' + variable.timetable[day][12].place_location + ' ' + variable.timetable[day][12].greeting);
                        console.log(secondvariable.messmenu[day].dinner);
                        // Push Message
                        // document.getElementById >> Inner html >> secondvariable.messmenu[day].breakfast
                    } else {
                        for (i = 0; i < variable.timetable[day].length; i++) {
                            if (i === 0){
                                continue
                            } else if (i === 4){
                                continue
                            } else if (i === 12){
                                continue
                            } else if ((clock > (i + 8) && clock < (i + 9)) && i !== prevlogged) {
                                prevlogged = i;
                                console.log(variable.timetable[day][i].event_name + ' ' + variable.timetable[day][i].place_location + ' ' + variable.timetable[day][i].greeting);
                                // Push Message
                                // document.getElementById >> Inner html 
                            }
                        }
                    }
            }, 1000);
        </script>
        
        <script>
            var thirdvariable = {
                "places" : [
                    {
                        "position" : {
                            "lat" : 29.87045809,
                            "lng" : 77.89470524,
                            "radius" : 0.00045329593700926216
                        },
                        "info" : {
                            "name" : "Rajendra Bhawan",
                            "greeting" : "Welcome to",
                            "activity": "Let's go to canteen",
                            "viewmodal": false,
                            "url": ""
                        }
                    },
                    {
                        "position" : {
                            "lat" : 29.87025457,
                            "lng" : 77.89647013,
                            "radius" : 0.000016319255503639917
                        },
                        "info" : {
                            "name" : "CCD",
                            "greeting" : "Welcome to",
                            "activity": "Let's have a coffee",
                            "viewmodal": true,
                            "url": "img/ccd.jpg"
                        }
                    },
                    {
                        "position" : {
                            "lat" : 29.87123377,
                            "lng" : 77.8995928,
                            "radius" : 0.0005542942143890002
                        },
                        "info" : {
                            "name" : "RKB",
                            "greeting" : "Welcome to",
                            "activity": "Home Sweet Home",
                            "viewmodal": true,
                            "url": "test1.jpg"
                        }
                    },
                    {
                        "position" : {
                            "lat" : 29.870876499999998,
                            "lng" : 77.89382279,
                            "radius" : 0.0003407115055338329
                        },
                        "info" : {
                            "name" : "LHC",
                            "greeting" : "Welcome to",
                            "activity": "Sweet Dreams",
                            "viewmodal": true,
                            "url": "img/timetable.jpg"
                        }
                    }
                ]
            };
            var lastplace = "";
            setInterval(getLocation, 1000);

            function getTimeTable() {
                
            }

            function getMessMenu() {

            }
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position){    
                        var mylat = position.coords.latitude;
                        var mylng = position.coords.longitude;
                        var latX = 0;
                        var lngX = 0;
                        var radius = 0;
                        var currentradius = 0;
                        for (i = 0; i < thirdvariable.places.length; i++) {
                            latX = thirdvariable.places[i].position.lat;
                            lngX = thirdvariable.places[i].position.lng;
                            radius = thirdvariable.places[i].position.radius;
                            currentradius = ((latX - mylat)*(latX - mylat) + (lngX - mylng)*(lngX - mylng));
                            if ((radius*radius - currentradius > 0) && (lastplace != thirdvariable.places[i].info.name)) {
                                console.log(thirdvariable.places[i].info.greeting + ' ' + thirdvariable.places[i].info.name + ' ' + thirdvariable.places[i].info.activity);
                                console.log(thirdvariable.places[i].info.name);
                                lastplace = thirdvariable.places[i].info.name;
                                if (thirdvariable.places[i].info.viewmodal === true){
                                    document.getElementById("imagebox").style.display = "block";
                                    var imageurl = thirdvariable.places[i].info.url;
                                    var newurl= 'url(' + imageurl + ')'
                                    console.log('url(' + imageurl+ ')');
                                    document.getElementById("imagebox").style.backgroundImage='url(' + imageurl+ ')';
                                } else {
                                    document.getElementById("imagebox").style.display = "none";
                                }
                            }
                        }
                    });
                } else {
                    console.log("Geolocation is off");
                }
            }
            </script>
    </body>
</html>